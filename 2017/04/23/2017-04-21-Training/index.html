<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>2017/04/21 Training | Kagami&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Tóm tắt đề bàiSEQUENCECho dãy số A[1..N]. Mỗi lần xóa ta sẽ xóa
tất cả các số mang một giá trị x nào đó.
Hỏi dãy dài nhất có thể tạo ra được mà không
tồn tại i &amp;lt; j &amp;lt; k thỏa mãn
A[i] == A[k] &amp;amp">
<meta property="og:type" content="article">
<meta property="og:title" content="2017/04/21 Training">
<meta property="og:url" content="http://natsukagami.github.io/2017/04/23/2017-04-21-Training/index.html">
<meta property="og:site_name" content="Kagami's Blog">
<meta property="og:description" content="Tóm tắt đề bàiSEQUENCECho dãy số A[1..N]. Mỗi lần xóa ta sẽ xóa
tất cả các số mang một giá trị x nào đó.
Hỏi dãy dài nhất có thể tạo ra được mà không
tồn tại i &amp;lt; j &amp;lt; k thỏa mãn
A[i] == A[k] &amp;amp">
<meta property="og:image" content="http://natsukagami.github.io/images/diskgame_exp.png">
<meta property="og:image" content="http://natsukagami.github.io/images/diskgame_sol.png">
<meta property="og:image" content="http://natsukagami.github.io/images/diskgame_func.png">
<meta property="og:updated_time" content="2017-04-23T10:17:42.076Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2017/04/21 Training">
<meta name="twitter:description" content="Tóm tắt đề bàiSEQUENCECho dãy số A[1..N]. Mỗi lần xóa ta sẽ xóa
tất cả các số mang một giá trị x nào đó.
Hỏi dãy dài nhất có thể tạo ra được mà không
tồn tại i &amp;lt; j &amp;lt; k thỏa mãn
A[i] == A[k] &amp;amp">
<meta name="twitter:image" content="http://natsukagami.github.io/images/diskgame_exp.png">
<meta name="twitter:creator" content="@natsukagami">
  
    <link rel="alternate" href="/atom.xml" title="Kagami&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>
  <script type="text/javascript">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'] ],
        displayMath: [ ['$$','$$'] ],
        processEscape: true
      }
    }); 
  </script>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Kagami&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">IOI Medalist, osu! lover, I tryhard everything.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://natsukagami.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2017-04-21-Training" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/23/2017-04-21-Training/" class="article-date">
  <time datetime="2017-04-23T01:11:00.000Z" itemprop="datePublished">2017-04-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Training/">Training</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2017/04/21 Training
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Tom-tat-de-bai"><a href="#Tom-tat-de-bai" class="headerlink" title="Tóm tắt đề bài"></a>Tóm tắt đề bài</h1><h2 id="SEQUENCE"><a href="#SEQUENCE" class="headerlink" title="SEQUENCE"></a>SEQUENCE</h2><p>Cho dãy số <code>A[1..N]</code>. Mỗi lần xóa ta sẽ xóa
tất cả các số mang một giá trị <code>x</code> nào đó.
Hỏi dãy dài nhất có thể tạo ra được mà không
tồn tại <code>i &lt; j &lt; k</code> thỏa mãn
<code>A[i] == A[k] &amp;&amp; A[i] != A[j]</code>?</p>
<h4 id="Gioi-han"><a href="#Gioi-han" class="headerlink" title="Giới hạn"></a>Giới hạn</h4><p><code>1 &lt;= N &lt;= 10^5</code>, <code>1 &lt;= A[i] &lt;= 100</code></p>
<h2 id="AVTOGAME"><a href="#AVTOGAME" class="headerlink" title="AVTOGAME"></a>AVTOGAME</h2><p>Cho xâu <code>S</code>. Mỗi bước ta có thể chọn một đoạn
<code>l &lt; r</code> sao cho <code>S[l] == S[r]</code> và xóa đoạn đó
khỏi xâu. Hỏi xâu ngắn nhất và dài nhất có thể
tạo được (mà không thể xóa được tiếp) là bao
nhiêu?</p>
<h4 id="Gioi-han-1"><a href="#Gioi-han-1" class="headerlink" title="Giới hạn"></a>Giới hạn</h4><p>10 test, <code>1 &lt;= |S| &lt;= 100</code>, <code>&#39;a&#39; &lt;= S[i] &lt;= &#39;p&#39;</code></p>
<h2 id="DISKGAME"><a href="#DISKGAME" class="headerlink" title="DISKGAME"></a>DISKGAME</h2><p>Cho một đĩa gồm <code>N</code> tầng xoay, mỗi tầng có <code>K</code>
nấc xoay như hình dưới.</p>
<p><img src="/images/diskgame_exp.png" alt="Một đĩa có 3 tầng, mỗi tầng có 8 nấc"></p>
<p>Mỗi bước ta được xoay 1 tầng sang trái hoặc phải
1 nấc. Hỏi số bước nhỏ nhất để tạo ra 1 cột có
các số bằng nhau là bao nhiêu?</p>
<p><img src="/images/diskgame_sol.png" alt="Một cách giải hình trên"></p>
<h4 id="Gioi-han-2"><a href="#Gioi-han-2" class="headerlink" title="Giới hạn"></a>Giới hạn</h4><p><code>1 &lt;= N, K &lt;= 2000</code></p>
<h1 id="Loi-giai"><a href="#Loi-giai" class="headerlink" title="Lời giải"></a>Lời giải</h1><h2 id="SEQUENCE-1"><a href="#SEQUENCE-1" class="headerlink" title="SEQUENCE"></a>SEQUENCE</h2><h3 id="Dieu-kien-cua-day-so"><a href="#Dieu-kien-cua-day-so" class="headerlink" title="Điều kiện của dãy số"></a>Điều kiện của dãy số</h3><p>Ta có thể thấy, 2 số <code>x</code> và <code>y</code> không được cùng
tồn tại trong đáp án nếu số <code>x</code> bị “kẹp giữa” số
<code>y</code> hoặc ngược lại. Ta cũng có thể dễ dàng
chứng minh một dãy không tồn tại cặp <code>x, y</code>
nào như vậy là một dãy thỏa mãn.</p>
<h4 id="Vi-du"><a href="#Vi-du" class="headerlink" title="Ví dụ"></a>Ví dụ</h4><p><code>1, 2, 1, 3, 1, 4</code> không thỏa mãn vì số <code>2</code> bị
kẹp giữa 2 lần số <code>1</code>.</p>
<p>Bài toán của ta trở thành đi tìm một dãy không
có 2 số nào “kẹp” nhau.</p>
<h3 id="Dau-va-duoi"><a href="#Dau-va-duoi" class="headerlink" title="Đầu và đuôi"></a>Đầu và đuôi</h3><p>Xét ví dụ ở trên, ta có thể thấy <code>2</code> bị kẹp
giữa bởi 2 số <code>1</code> ở vị trí 1 và 3. Ta cũng có
thể nói <code>2</code> bị kẹp giữa bởi 2 số <code>1</code> ở 1 và 5.</p>
<p>Giả sử <code>x</code> kẹp giữa <code>y</code> ở 2 vị trí <code>a &lt;= b</code>,
ta cũng có thể nói <code>x</code> kẹp ở 2 vị trí <code>first[x] &lt;= a</code>
và <code>b &lt;= last[x]</code> (2 lần xuất hiện đầu và cuối
của <code>x</code>). Như vậy điều kiện để <code>x</code> kẹp giữa <code>y</code>
chỉ là tồn tại <code>y</code> nằm giữa 2 vị trí xa nhau nhất
chứa <code>x</code>.</p>
<p>Đi xa hơn, ta có thể thấy xét trên trục 1 chiều,
tồn tại cặp <code>x</code>, <code>y</code> kẹp nhau khi và chỉ khi 2 đoạn
<code>(first[x], last[x])</code> và <code>(first[y], last[y])</code>
giao nhau.</p>
<h3 id="Quy-hoach-dong"><a href="#Quy-hoach-dong" class="headerlink" title="Quy hoạch động"></a>Quy hoạch động</h3><p>Như vậy, ta chỉ cần tìm 1 tập số sao cho tập
<code>(first[x], last[x])</code> của các số không giao nhau.
Đây là bài toán quy hoạch động cơ bản, có thể thực
hiện quy hoạch động trong
<code>O(N + M)</code> với <code>M</code> là số phần tử khác nhau.</p>
<p>Gọi <code>f[i]</code> là số đoạn thẳng nhiều nhất ta có
thể chọn trong khoảng <code>1..i</code>. Từ đây, ta có 2
lựa chọn:</p>
<ul>
<li>Thêm khoảng không, cập nhật <code>f[i]</code> cho <code>f[i + 1]</code>.</li>
<li>Thêm một đoạn <code>(i + 1..j)</code>. Ta duyệt tất cả các
đoạn thẳng có đầu mút trái là <code>i + 1</code> và cập nhật
<code>f[i] + 1</code> cho <code>f[j]</code>.</li>
</ul>
<p>Đáp số là <code>f[N]</code>.</p>
<h2 id="AVTOGAME-1"><a href="#AVTOGAME-1" class="headerlink" title="AVTOGAME"></a>AVTOGAME</h2><h3 id="Co-the-xoa-1-doan"><a href="#Co-the-xoa-1-doan" class="headerlink" title="Có thể xóa 1 đoạn?"></a>Có thể xóa 1 đoạn?</h3><p>Hiển nhiên các đoạn ta xóa sẽ không giao nhau,
nên chỉ có 2 khả năng xảy ra để xóa đoạn <code>[a &lt; b]</code>:</p>
<ul>
<li>Nếu <code>S[a] == S[b]</code> ta xóa cả đoạn trong 1 bước.</li>
<li>Chọn 1 vị trí <code>a &lt; k &lt; b - 1</code>, xóa đoạn <code>a..k</code>
rồi xóa đoạn <code>k+1..b</code>.</li>
</ul>
<p>Dựa vào nhận xét này, ta dễ dàng dựng nên mảng
<code>canErase[l][r]</code> (có thể xóa đoạn <code>l..r</code> không?)
trong <code>O(N^3)</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= N; ++l) &#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> r = l + <span class="number">1</span>; r &lt;= N; ++r) &#123;</div><div class="line">    <span class="keyword">if</span> (S[l] == S[r]) canErase[l][r] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = l + <span class="number">1</span>; k + <span class="number">1</span> &lt; r; ++k) &#123;</div><div class="line">      canErase[l][r] = canErase[l][r] || (canErase[l][k] &amp;&amp; canErase[k + <span class="number">1</span>][r]);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Chi-phi-xoa-het-nho-nhat"><a href="#Chi-phi-xoa-het-nho-nhat" class="headerlink" title="Chi phí xóa hết nhỏ nhất"></a>Chi phí xóa hết nhỏ nhất</h3><p>Thay vì giải bài toán xâu ngắn nhất còn lại,
ta sẽ thay đổi bài toán bằng cách cho phép một
kiểu xóa nữa: xóa <strong>1 kí tự</strong> với chi phí 1.
Sau đó ta đi tìm chi phí nhỏ nhất để xóa
cả dãy. Ta có thể thấy tính chất các bước
xóa rời nhau không thay đổi.</p>
<p>Hiển nhiên chi phí sẽ bằng đáp án, vì ta không
bao giờ xóa đơn lẻ 2 kí tự giống nhau.</p>
<p>Để giải được bài toán này, ta cải tiến thuật
toán kiểm tra tính xóa được phía trên, thành
chi phí nhỏ nhất để xóa đoạn <code>l..r</code>. Hiển
nhiên <code>cost[i][i] = 1</code> vì chỉ có 1 kí tự. Với
đoạn <code>l..r</code> ta có 2 cách xóa:</p>
<ul>
<li>Nếu <code>S[l] == S[r]</code> ta xóa cả đoạn với chi
phí 0.</li>
<li>Chọn <code>l &lt;= k &lt; r</code> rồi xóa 2 đoạn <code>l..k</code> và
<code>k + 1..r</code> với tổng chi phí
<code>cost[l][k] + cost[k + 1][r]</code>.</li>
</ul>
<p>Đáp số là <code>cost[1][N]</code>, độ phức tạp là <code>O(N^3)</code>.</p>
<h3 id="Cac-ki-tu-con-lai"><a href="#Cac-ki-tu-con-lai" class="headerlink" title="Các kí tự còn lại"></a>Các kí tự còn lại</h3><p>Để giải được bài toán dãy còn lại dài nhất,
ta cần phải thấy tính chất của dãy còn lại.
Tính chất khá đơn giản: không tồn tại 2 kí
tự giống nhau trong xâu. Như vậy, ta cần
nhặt ra 1 tập kí tự khác nhau sao cho các phần
ở giữa có thể xóa được.</p>
<p>Điều kiện chỉ có 16 kí tự khác nhau cho ta
một gợi ý: sử dụng bitmask để quản lí các
kí tự đã lấy.</p>
<h3 id="Quy-hoach-dong-1"><a href="#Quy-hoach-dong-1" class="headerlink" title="Quy hoạch động"></a>Quy hoạch động</h3><p>Gọi <code>bool f[i][mask]</code> là tính khả thi của
việc chọn ra tập kí tự thỏa mãn <code>mask</code> trong đoạn
<code>1..i</code> và xóa hết các kí tự còn lại, trong đó
kí tự cuối ta chọn chính là <code>S[i]</code>. Ta có 2 lựa
chọn:</p>
<ul>
<li>Chọn cả kí tự <code>S[i - 1]</code>, với điều kiện
<code>S[i - 1] != S[i]</code> và <code>mask</code> có <code>S[i - 1]</code>. Ta
lùi về trạng thái <code>f[i - 1][mask ^ S[i]]</code>.</li>
<li>Chọn một vị trí <code>j &lt; i</code> và lấy kí tự này là
kí tự đứng ngay trước <code>S[i]</code>. Điều kiện là
<code>S[j] != S[i]</code>, <code>mask</code> có <code>S[j]</code> và <code>j + 1..i - 1</code>
xóa được. Ta lùi về trạng thái <code>f[j][mask ^ S[i]]</code>.</li>
</ul>
<p>Độ phức tạp sẽ là <code>O(N^2 * 2^16)</code>, chưa thể
thỏa mãn bài toán. Ta cần một chút cải tiến để
xóa bớt <code>N</code>.</p>
<h3 id="Nhay-chon-va-xoa"><a href="#Nhay-chon-va-xoa" class="headerlink" title="Nhảy, chọn và xóa"></a>Nhảy, chọn và xóa</h3><p>Ta sẽ chỉnh sửa hàm quy hoạch động một chút: xóa
bỏ điều kiện <code>S[i]</code> là kí tự cuối cùng chọn.
Thay vào đó, ta “nhảy” từng bước, chọn hoặc sử
dụng duy nhất một phép xóa. Cụ thể, từ trạng thái
<code>f[i][mask]</code>, ta có:</p>
<ul>
<li><code>S[i]</code> là kí tự được chọn. Điều kiện là <code>mask</code>
chứa <code>S[i]</code>. Lùi về <code>f[i - 1][mask ^ S[i]]</code>.</li>
<li><code>S[i]</code> là kí tự cuối cùng bị xóa. Vậy ta cần
một vị trí <code>j &lt; i</code> sao cho <code>S[i] == S[j]</code>, và lùi
về <code>f[j - 1][mask]</code>.</li>
</ul>
<p>Thoáng qua, vẫn là <code>O(N^2 * 2^16)</code>. Làm sao để
cải tiến? Ta thấy, trong trường hợp 2, điều kiện
duy nhất là <code>S[j] == S[i]</code>, mà chỉ có 16 loại kí tự,
vậy ta hoàn toàn có thể lưu lại tất cả các trường
hợp <code>f[j - 1][mask]</code> với mỗi lọai <code>S[j]</code> khác nhau.</p>
<p>Gọi <code>g[i][mask]</code> là tổng kết tất cả các trường hợp
<code>f[j][mask]</code> thỏa mãn <code>S[j + 1] == i</code>. Ta có thể
vừa đi vừa cập nhật <code>g[S[i + 1]][mask]</code>, đồng thời
trong trường hợp 2 ta chỉ cần lấy giá trị của
<code>g[S[i]][mask]</code> trong <code>O(1)</code>.</p>
<p>Độ phức tạp giảm xuống còn <code>O(N * 2^16)</code>,
thỏa mãn bài toán.</p>
<h2 id="DISKGAME-1"><a href="#DISKGAME-1" class="headerlink" title="DISKGAME"></a>DISKGAME</h2><h3 id="Chi-phi-xoay-cua-1-dia"><a href="#Chi-phi-xoay-cua-1-dia" class="headerlink" title="Chi phí xoay của 1 đĩa"></a>Chi phí xoay của 1 đĩa</h3><p>Hãy phân tích chi phí xoay của 1 đĩa để có
số <code>n</code> ở vị trí <code>p</code>. Hiển nhiên chi phí là
<code>min(|x - p|)</code> với <code>x</code> là các vị trí xuất hiện
của <code>n</code> trong đĩa.</p>
<p>Thực chất ta chỉ cần xét đến 2 vị trí gần nhất
bên trái và bên phải của <code>p</code>. Ta tạm gọi là
<code>x</code> và <code>y</code> (để đơn giản ta coi <code>x &lt;= p &lt;= y</code>).
Chi phí sẽ là <code>min(p - x, y - p)</code>. Dễ dàng nhận
thấy <code>p - x</code> là hàm tăng 1 đơn vị, <code>y - p</code> là
hàm giảm 1 đơn vị với <code>x &lt;= p &lt;= y</code>. min của
2 hàm này sẽ là “núi” góc 45 độ có chóp ở trung
điểm của <code>x</code> và <code>y</code> (hoặc có chóp ngang nếu trung
điểm không nguyên).</p>
<p>Nếu ta xét tất cả các cặp vị trí liên tiếp của
số, thì chi phí sẽ là nhiều “ngọn núi” như vậy.</p>
<p>Ta có thể thấy chi phí là một hàm như hình dưới,
cho dãy <code>1 2 3 1 2 3 5 1 5</code> với <code>n = 1</code>. Lưu ý
đoạn <code>8, 9, 1</code> cũng là 1 “ngọn núi”, vì thực chất
đĩa là hình tròn.</p>
<p><img src="/images/diskgame_func.png" alt="Hàm chi phí"></p>
<p>Ta có thể cắt hàm thành các đường chéo tăng và
giảm 45 độ để đơn giản hóa việc tính toán chi
phí cho tất cả các đĩa.</p>
<p>Tổng cộng 1 đĩa sẽ bị cắt thành <code>2K</code> đường chéo.</p>
<h3 id="Tinh-tong-chi-phi-cho-moi-dia"><a href="#Tinh-tong-chi-phi-cho-moi-dia" class="headerlink" title="Tính tổng chi phí cho mọi đĩa"></a>Tính tổng chi phí cho mọi đĩa</h3><p>Với mỗi vị trí <code>p</code> và một số <code>n</code>, ta cần tính
tổng chi phí xoay với mọi đĩa trong <code>O(1)</code>.
Biết chúng là tổng các đường chéo, làm sao
để tính nhanh?</p>
<p>Ta sẽ vận dụng tính chất chúng đều có dạng <code>x + b</code>
hoặc <code>-x + b</code> và sử dụng đường quét để tính
với mỗi <code>n</code>.</p>
<p>Ta thấy, khi có <code>k</code> đoạn <code>x + b[i]</code>, chi phí là
<code>kx + sum(b[i])</code> với bước tăng là <code>k</code>.
Vì vậy thực chất với mỗi vị
trí ta chỉ cần biết số đoạn tăng và tổng phần
hằng số của chúng. Ta hoàn toàn có thể làm
điều này khi quét bằng cách xét 2 đầu mút đầu
(thêm đoạn) và cuối (xóa đoạn) sau đó xử lí
từ trái sang phải.</p>
<p>Điều tương tự cũng đúng với hàm giảm.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> b[N * K + <span class="number">1</span>]; <span class="comment">// tất cả b[i] của các đường tăng</span></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; add[K + <span class="number">2</span>], remove[K + <span class="number">2</span>]; <span class="comment">// các mốc thêm xóa</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addSegment</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">  <span class="comment">// thêm đoạn [l..r] = x + b[id]</span></div><div class="line">  add[l].push_back(id);</div><div class="line">  remove[r + <span class="number">1</span>].push_back(id);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="keyword">int</span> value = <span class="number">0</span>, cnt = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> p: add[i]) &#123;</div><div class="line">      value += b[p] + i - <span class="number">1</span>; <span class="comment">// giá trị của i trước đó</span></div><div class="line">      ++cnt;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> p: remove[i]) &#123;</div><div class="line">      value -= b[p] + i - <span class="number">1</span>;</div><div class="line">      --cnt;</div><div class="line">    &#125;</div><div class="line">    value += cnt;</div><div class="line">    <span class="comment">// value là tổng ở vị trí i</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Ta có thể thấy độ phức tạp với mỗi <code>n</code> là <code>O(K + số đoạn của n)</code>.
Vì thế tổng độ phức tạp là <code>O(K^2 + NK)</code>, do có <code>2NK</code> đoạn tất cả.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://natsukagami.github.io/2017/04/23/2017-04-21-Training/" data-id="cj1uk5kqb000evs2b3zcyhou2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apio/">apio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/thay-Nghia/">thầy Nghĩa</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/training/">training</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vietnamese/">vietnamese</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2017/04/21/2017-04-20-Training/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2017/04/20 Training</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Thoughts/">Thoughts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Training/">Training</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/First-Post/">First Post</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/anh-Hanh/">anh Hạnh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/anh-Minh/">anh Minh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apio/">apio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/english/">english</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thay-Nghia/">thầy Nghĩa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thay-Phuong/">thầy Phương</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thay-Dong/">thầy Đông</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/training/">training</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vietnamese/">vietnamese</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/First-Post/" style="font-size: 10px;">First Post</a> <a href="/tags/anh-Hanh/" style="font-size: 10px;">anh Hạnh</a> <a href="/tags/anh-Minh/" style="font-size: 10px;">anh Minh</a> <a href="/tags/apio/" style="font-size: 20px;">apio</a> <a href="/tags/english/" style="font-size: 10px;">english</a> <a href="/tags/thay-Nghia/" style="font-size: 10px;">thầy Nghĩa</a> <a href="/tags/thay-Phuong/" style="font-size: 10px;">thầy Phương</a> <a href="/tags/thay-Dong/" style="font-size: 10px;">thầy Đông</a> <a href="/tags/training/" style="font-size: 20px;">training</a> <a href="/tags/vietnamese/" style="font-size: 15px;">vietnamese</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/04/23/2017-04-21-Training/">2017/04/21 Training</a>
          </li>
        
          <li>
            <a href="/2017/04/21/2017-04-20-Training/">2017/04/20 Training</a>
          </li>
        
          <li>
            <a href="/2017/04/19/2017-04-19-Training/">2017/04/19 Training</a>
          </li>
        
          <li>
            <a href="/2017/04/18/2017-04-18-Training/">2017/04/18 Training</a>
          </li>
        
          <li>
            <a href="/2017/04/16/2017-04-15-Training/">2017/04/15 Training</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Natsu Kagami<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>